<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pantalla de Color</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            background-color: white;
            transition: background-color 0.5s ease;
        }
        #colorText {
            width: 100%;
            text-align: center;
            padding: 10px;
            font-size: 1.5em; /* Tamaño de letra más pequeño */
            color: white; /* Texto blanco */
            position: fixed;
            top: 0;
            left: 0;
        }
        #fullscreenButton {
            position: fixed;
            bottom: 20px;
            font-size: 1.5em;
            padding: 10px 20px;
            background-color: black;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="colorText">Burning Cold dice!!!: Cargando color...</div>

    <!-- Botón para activar pantalla completa -->
    <button id="fullscreenButton" onclick="launchFullScreen(document.documentElement)">Pantalla Completa</button>

    <!-- Firebase JS SDK (versión 8) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // Configuración de Firebase (solo la URL de la base de datos)
        var firebaseConfig = {
            databaseURL: "https://colorburningcold-default-rtdb.firebaseio.com"
        };

        // Inicializamos Firebase
        firebase.initializeApp(firebaseConfig);

        // Conexión a la base de datos en tiempo real
        var database = firebase.database();
        var colorRef = database.ref('BurningApp/color');

        let currentColor = { r: 255, g: 255, b: 255 }; // Color inicial (blanco)
        let targetColor = { r: 255, g: 255, b: 255 }; // Color objetivo

        // Función para cambiar el color de fondo con fusión
        function cambiarColor(color) {
            console.log("Cambiando color a:", color);  // Depuración
            const [r, g, b] = colorToRgb(color);
            targetColor = { r, g, b };
            animateColorTransition();
        }

        // Convertir nombre de color a valores RGB
        function colorToRgb(color) {
            const colors = {
                'blue': [0, 0, 255],
                'red': [255, 0, 0],
                'yellow': [255, 255, 0],
                'white': [255, 255, 255]
            };
            return colors[color] || [255, 255, 255]; // Blanco como color por defecto
        }

        // Función para animar la transición de colores
        function animateColorTransition() {
            function update() {
                // Interpolación de colores
                currentColor.r += (targetColor.r - currentColor.r) * 0.1;
                currentColor.g += (targetColor.g - currentColor.g) * 0.1;
                currentColor.b += (targetColor.b - currentColor.b) * 0.1;

                document.body.style.backgroundColor = `rgb(${Math.round(currentColor.r)}, ${Math.round(currentColor.g)}, ${Math.round(currentColor.b)})`;

                // Continuar la animación si no se ha alcanzado el color objetivo
                if (Math.abs(currentColor.r - targetColor.r) > 1 || Math.abs(currentColor.g - targetColor.g) > 1 || Math.abs(currentColor.b - targetColor.b) > 1) {
                    requestAnimationFrame(update);
                }
            }
            requestAnimationFrame(update);
        }

        // Escuchar cambios en el valor del color en la base de datos
        colorRef.on('value', function(snapshot) {
            var color = snapshot.val();

            // Eliminar comillas dobles si están presentes
            color = color.replace(/['"]+/g, '');  // Elimina comillas

            console.log("Valor leído desde Firebase sin comillas:", color);  // Depuración
            cambiarColor(color);
        });

        // Forzar pantalla completa y ocultar botón
        function launchFullScreen(element) {
            if (element.requestFullscreen) {
                element.requestFullscreen();
            } else if (element.mozRequestFullScreen) { // Firefox
                element.mozRequestFullScreen();
            } else if (element.webkitRequestFullscreen) { // Chrome, Safari, Opera
                element.webkitRequestFullscreen();
            } else if (element.msRequestFullscreen) { // IE/Edge
                element.msRequestFullscreen();
            }

            // Ocultar el botón después de activar la pantalla completa
            document.getElementById('fullscreenButton').style.display = 'none';
        }

        // Mostrar el botón nuevamente cuando se salga del modo de pantalla completa
        document.addEventListener("fullscreenchange", function() {
            if (!document.fullscreenElement) {
                document.getElementById('fullscreenButton').style.display = 'block';
            }
        });
    </script>
</body>
</html>

